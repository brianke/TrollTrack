<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="TrollTrack.Features.Dashboard.DashboardView"
             xmlns:f="clr-namespace:TrollTrack.Features.Dashboard"
             x:DataType="f:DashboardViewModel">

    <RefreshView IsRefreshing="{Binding IsRefreshing}"
                 Command="{Binding RefreshDashboardCommand}">

        <ScrollView>
            <VerticalStackLayout Spacing="15" Padding="15">

                <Label Text="{Binding RefreshStatus}" 
                       Style="{StaticResource InfoLabel}"
                       Margin="0,0,0,5"/>

                <!-- Current Location -->
                <Border Style="{StaticResource InfoCard}">
                    <StackLayout>
                        <HorizontalStackLayout HorizontalOptions="Center">
                            <Label Text="ðŸ“" Style="{StaticResource CardTitle}" />
                            <Label Text="{Binding LocationName}" Style="{StaticResource CardTitle}" />
                        </HorizontalStackLayout>

                        <Grid Margin="0,10,0,0" ColumnDefinitions=".15*,.25*,.15*" RowDefinitions="Auto,Auto">
                            <!-- Latitude -->
                            <Label Text="Latitude:" FontAttributes="Bold" VerticalOptions="Center" Grid.Row="0" Grid.Column="0" />
                            <Label Text="{Binding FormattedLatitude}" Style="{StaticResource DataLabel}" Margin="10,0,0,0" Grid.Row="0" Grid.Column="1" />
                            <Label Text="{Binding CurrentLatitude, StringFormat='{0:F6}'}" Style="{StaticResource SubtleDataLabel}" VerticalTextAlignment="Center" Margin="10,0,0,0" Grid.Row="0" Grid.Column="2" />

                            <!-- Longitude -->
                            <Label Text="Longitude:" FontAttributes="Bold" VerticalOptions="Center" Grid.Row="1" Grid.Column="0" />
                            <Label Text="{Binding FormattedLongitude}" Style="{StaticResource DataLabel}" Margin="10,0,0,0" Grid.Row="1" Grid.Column="1" />
                            <Label Text="{Binding CurrentLongitude, StringFormat='{0:F6}'}" Style="{StaticResource SubtleDataLabel}" VerticalTextAlignment="Center" Margin="10,0,0,0" Grid.Row="1" Grid.Column="2" />
                        </Grid>
                    </StackLayout>
                </Border>

                <!-- Weather Information -->
                <Border Style="{StaticResource InfoCard}" Padding="10">
                    <StackLayout>
                        <Label Text="ðŸŒ¤ï¸ Current Weather Conditions" Style="{StaticResource CardTitle}" />
                        <Grid Margin="5" ColumnDefinitions="*,*,*">
                            <StackLayout Grid.Column="0">
                                <Label Text="{Binding WeatherEntity.Temperature, StringFormat='{0:F0}Â°'}" FontSize="36" FontAttributes="Bold" HorizontalOptions="Center" />
                                <Label Text="{Binding WeatherEntity.WeatherCondition, StringFormat='â˜ï¸ {0}'}" FontAttributes="Bold" HorizontalOptions="Center"/>
                                <HorizontalStackLayout HorizontalOptions="Center" Margin="0,5,0,0">
                                    <Label Text="{Binding WeatherEntity.WindSpeed,StringFormat='ðŸ’¨ {0:F0} mph'}" FontAttributes="Bold"/>
                                    <Label Text="  " />
                                    <Label Text="âž¤" Rotation="{Binding WeatherEntity.WindDirection}" />
                                </HorizontalStackLayout>
                            </StackLayout>

                            <StackLayout Grid.Column="1">
                                <Image Source="sunrise.png" MaximumHeightRequest="70" Margin="0,0,0,10"/>
                                <Label Text="{Binding WeatherEntity.Sunrise, StringFormat='{0:HH:mm tt}'}" FontSize="16" FontAttributes="Bold" HorizontalOptions="Center"/>
                            </StackLayout>

                            <StackLayout Grid.Column="2">
                                <Image Source="sunset.png" MaximumHeightRequest="78" Margin="0,2,0,0"/>
                                <Label Text="{Binding WeatherEntity.Sunset, StringFormat='{0:HH:mm tt}'}" FontSize="16" FontAttributes="Bold" HorizontalOptions="Center"/>
                            </StackLayout>
                        </Grid>
                    </StackLayout>
                </Border>
            </VerticalStackLayout>
        </ScrollView>
    </RefreshView>
</ContentPage>